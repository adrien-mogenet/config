;; -------------------------------------------------------------------------
;; GLOBAL CONFIGURATION
;; -------------------------------------------------------------------------

;; Personal informations
(setq user-full-name "Adrien Mogenet"
      user-mail-address "adrien.mogenet@gmail.com"
      signature-file "~/.signature")

;; Load modules
(add-to-list 'load-path "~/.emacs.d/")
(load-file "~/.emacs.d/pabbrev.el")
(load-file "~/.emacs.d/puppet/puppet-mode.el")
(load-file "~/.emacs.d/puppet/puppet-mode-init.el")
(load-file "~/.emacs.d/puppet-ext.el")
(load-file "~/.emacs.d/php-mode-1.5.0/php-mode.el")
(load-file "~/.emacs.d/css-mode.el")
(load-file "~/.emacs.d/mac-key-mode.el")

;; Custom configuration files
(load-file "~/.emacs.d/lang/clojure.el")
(load-file "~/.emacs.d/lang/shell.el")
(load-file "~/.emacs.d/lang/c.el")
(load-file "~/.emacs.d/bindings.el")
(load-file "~/.emacs.d/display.el")

;; Encoding
(setq locale-coding-system 'utf-8)
(set-terminal-coding-system 'utf-8)
(set-keyboard-coding-system 'utf-8)
(set-selection-coding-system 'utf-8)
(prefer-coding-system 'utf-8)
(set-language-environment 'utf-8)

;; Custom basis behavior
(add-hook 'white-file-hooks 'delete-trailing-whitespaces)
(setq-default indicate-empty-lines t)
(setq-default show-trailing-whitespace t)
(add-hook 'text-mode-hook 'turn-on-auto-fill)
(setq text-mode-hook 'turn-on-auto-fill)
(setq fill-column 80)

;; Tab policy
(setq-default indent-tabs-mode nil)
(setq-default tab-width 2)
(setq sh-basic-offset 2
      sh-indentation 2)
(setq standard-indent 2)

;; Set modes from file extensions
(add-to-list 'auto-mode-alist '("configure$" . sh-mode))
(add-to-list 'auto-mode-alist '("\\.rb$" . ruby-mode))
(add-to-list 'auto-mode-alist '("Drakefile$" . ruby-mode))
(add-to-list 'auto-mode-alist '("emacs$" . lisp-mode))
(add-to-list 'auto-mode-alist '("\\.m$" . octave-mode))
(add-to-list 'auto-mode-alist '("\\.css$" . css-mode))
(add-to-list 'auto-mode-alist '("\\.ctp$" . html-mode))

;; Options
(add-hook 'after-init-hook 'global-company-mode)
(setq normal-erase-is-backspace-mode t) ; make delete work as it should
(fset 'yes-or-no-p 'y-or-n-p)           ; 'y or n' instead of 'yes or no'
(setq default-major-mode 'text-mode)    ; change default major mode to text
(setq ring-bell-function 'ignore)       ; turn the alarm totally off
(setq make-backup-files nil)            ; no backupfile
(global-auto-revert-mode t)             ; auto revert modified files
;(pc-selection-mode)                     ; selection with shift
(auto-image-file-mode)                  ; to see picture in emacs
(add-hook 'write-file-hooks 'delete-trailing-whitespace) ; Trailing spaces
(setq compilation-window-height 10)     ; size of compilation window
(setq-default gdb-many-windows t)       ; Better gdb
(setq require-final-newline t)          ; make edited files end with a \n
(setq compilation-scroll-output t)      ; va tjs en bas de la fenetre de compile
(show-paren-mode t)                     ; Paren match highlighting

;; Autosave
(custom-set-variables
 '(auto-save-file-name-transforms '((".*" "~/.emacs.d/autosaves/\\1" t)))
 '(backup-directory-alist '((".*" . "~/.emacs.d/backups/"))))
(make-directory "~/.emacs.d/autosaves/" t) ;; create the autosave dir


;; -------------------------------------------------------------------------
;; MODULES CONFIGURATIONS
;; -------------------------------------------------------------------------

;; Ido-mode
(setq ido-confirm-unique-completion t)
(ido-mode t)
;; If the file doesn't exist, we want a new file.
(setq ido-auto-merge-work-directories-length -1)
(setq ido-ignore-buffers ;; Don't switch to GDB-mode buffers
      (quote ("\\`\\*breakpoints of.*\\*\\'"
              "\\`\\*stack frames of.*\\*\\'"
              "\\`\\*gud\\*\\'"
              "\\`\\*locals of.*\\*\\'"
              "\\` ")))

;; Uniquify - enhanced unique buffer names
(require 'uniquify)
(setq uniquify-buffer-name-style 'post-forward-angle-brackets)

;; Ispell
(require 'ispell)
(setq ispell-dictionary "francais")
(add-hook 'LaTeX-mode-hook 'flyspell-mode)

;; Pabbrev, predictive mode
(require 'pabbrev)
(global-pabbrev-mode)

;; Mac-key-mode
(setq mac-command-modifier 'alt mac-option-modifier 'meta)
(require 'mac-key-mode)
(mac-key-mode 1)

;; Rainbow-mode
(require 'rainbow-mode)
(require 'rainbow-delimiters)
(rainbow-mode t)
(global-rainbow-delimiters-mode)

;; Company mode
(add-hook 'after-init-hook 'global-company-mode)


;; -------------------------------------------------------------------------
;; ADVANCED CUSTOM OPTIONS
;; -------------------------------------------------------------------------

;; Put it at the end of config file
(custom-set-variables
 ;; custom-set-variables was added by Custom.
 ;; If you edit it by hand, you could mess it up, so be careful.
 ;; Your init file should contain only one such instance.
 ;; If there is more than one, they won't work right.
 '(column-number-mode t)
 '(ecb-options-version "2.32")
 '(mac-allow-anti-aliasing nil)
 '(mac-font-panel-mode nil)
 '(mac-input-method-mode nil)
 '(transient-mark-mode t))
(custom-set-faces
 ;; custom-set-faces was added by Custom.
 ;; If you edit it by hand, you could mess it up, so be careful.
 ;; Your init file should contain only one such instance.
 ;; If there is more than one, they won't work right.
 )
(setq ring-bell-function #'ignore)
